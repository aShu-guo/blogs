# CPU

中央处理器 （英语：Central Processing Unit，缩写：CPU）是计算机的主要设备之一，功能主要是解释计算机指令以及处理计算机软件中的数据。

在此讨论的是遵循普遍的冯·诺伊曼结构（von Neumann architecture）设计的设备，冯·诺伊曼结构与存储程序型电脑是互相通用的名词。

差不多所有的冯·诺伊曼CPU的运作原理可分为四个阶段：`提取`、`解码`、`执行`和`写回`。

## 组成

计算器、控制器、存储器、I/O

## 流水线

在计算机发展早期，处理器和主内存之间运行速度的差别变得越来越大。在这些因素促使下，出现了一系列新技术，使处理器的指令得以流水执行，同时降低处理器访问内存的次数。

CPU 流水线指的是将 CPU 执行分为几个步骤，并且每个时钟时序每个步骤都在工作，相当于并行同时执行 n 条指令，n 为流水线步数

![img.png](/imgs/computes-course/cpu-pipline.png)

特点：

- 流水线并不会提高单条指令的执行速度，但是可以增加整体的吞吐量
- 流水线的速度本身会被最慢的那个步骤所限制
- 每个流水线步骤之间的执行速度相差很多/不够平均，那么反而会减慢整体指令执行速度
- 流水线步骤越多，这个“填满/放掉”的过程会越长。

## 性能指标

- CPI:执行每条指令所需要的平均时钟周期
- IPS：每秒能执行的指令数
    - 不同机器的指令集不同
    - 程序由不同的指令混合而成
    - 指令使用的频度动态变化
- MIPS：每秒能执行的n百万指令数
    - 因为每条指令执行时间不同，所以MIPS总是一个平均值
- FLOPS：每秒的浮点运算次数
    - 与机器相关性大
    - 并不是程序中花时间的部分
- MLOPS：每秒的百万浮点运算次数
- cycle（时钟周期）:1/主频
    - kHz 10<sup>3</sup>
    - MHz 10<sup>6</sup>
    - GHz 10<sup>9</sup>
    - THz 10<sup>12</sup>

## 总结

1. 一般的，`程序的响应时间`=`CPU时间`+`等待时间`，CPU时间又分成`用户CPU时间`和`系统CPU时间`。
2. 因为操作系统对自己所花费的时间进行测量时，不十分准确，所以，对`CPU性能的测算一般通过测算用户CPU时间`来进行。
