# initProps

组件中的 props 可以有多种形式：

## 数组形式（最简单）

```js
export default {
  props: ['title', 'count', 'message'],
};
```

## 对象形式 - 仅指定类型

```js
export default {
  props: {
    title: String,
    count: Number,
    active: Boolean,
  },
};
```

## 对象形式 - 完整选项

```js
export default {
  props: {
    title: {
      type: String,
      required: true,
    },
    count: {
      type: Number,
      default: 0,
    },
    message: {
      type: String,
      default: () => 'hello', // 工厂函数
      validator: (value) => value.length > 0,
    },
    active: Boolean, // 简写 - 仅类型
  },
};
```

## 混合形式

```js
export default {
  props: {
    title: String, // 简写
    count: {
      // 完整选项
      type: Number,
      default: 0,
    },
    active: [String, Boolean], // 多类型
  },
};
```

## 带 mixins/extends

```js
// mixin.ts
export const myMixin = {
  props: {
    mixinProp: String,
  },
};

// component.ts
export default {
  mixins: [myMixin],
  props: {
    componentProp: String,
  },
};
```

## 最终标准后的props结构

```js
const [props, keys] = [
    // 第一个元素: NormalizedProps 对象
    {
      title: {
        type: [Function: String] // 对应String
        // 没有 BooleanFlags.shouldCast（不是 Boolean）
        // 没有 default（非必需）
      },

      count: {
        type: [Function: Number],
        default: 0,
        // default 字段保留
        // 被加入 needCastKeys（因为有 default）
      },

      active: {
        type: [Function: Boolean],
        [BooleanFlags.shouldCast]: true,      // Symbol 键！需要布尔转换
        [BooleanFlags.shouldCastTrue]: true,  // Symbol 键！转换为 true/false
        // 被加入 needCastKeys（因为是 Boolean）
      },

      message: {
        type: [[Function: String], [Function: Boolean]],
        [BooleanFlags.shouldCast]: true,       // 数组中包含 Boolean
        [BooleanFlags.shouldCastTrue]: false,  // String 在 Boolean 之前，所以特殊处理
        // 被加入 needCastKeys（因为有 Boolean）
      },
    },

    // 第二个元素: needCastKeys 数组（需要值转换的 prop 名称）
    ['count', 'active', 'message'];  // 只有这些 props 需要在 resolvePropValue 中处理
]
```

needCastKeys、shouldCastTrue、shouldCast的作用用于处理props有多个数据类型的case，用于处理以下用例

```js
export default {
  props: {
    title: {
      type: [String, Number],
      default: '',
    },
    foo: {
      type: Boolean,
      default: '',
    },
    bun: {
      type: [Number, String],
      default: '',
    },
  },
};
```

| 定义                       | 空字符串处理 | 目的                       |
| -------------------------- | ------------ | -------------------------- |
| active: Boolean            | '' → true ✅ | 遵循 HTML boolean 属性语义 |
| value: [String, Boolean]   | '' → '' ✅   | String 优先，保留空字符串  |
| checked: [Boolean, String] | '' → true ✅ | Boolean 优先，转为 true    |
